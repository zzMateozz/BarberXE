{"version":3,"sources":["../../src/connection/ConnectionManager.ts"],"names":[],"mappings":";;;AAAA,0DAAsD;AACtD,8EAA0E;AAE1E,8FAA0F;AAE1F;;;;;GAKG;AACH,MAAa,iBAAiB;IAA9B;QAQI;;WAEG;QACc,kBAAa,GAA4B,IAAI,GAAG,EAAE,CAAA;IA+CvE,CAAC;IAzDG;;OAEG;IACH,IAAI,WAAW;QACX,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC,CAAA;IAClD,CAAC;IAOD,4EAA4E;IAC5E,iBAAiB;IACjB,4EAA4E;IAE5E;;OAEG;IACH,GAAG,CAAC,IAAY;QACZ,OAAO,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;IACvC,CAAC;IAED;;;;OAIG;IACH,GAAG,CAAC,OAAe,SAAS;QACxB,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;QAC/C,IAAI,CAAC,UAAU;YAAE,MAAM,IAAI,iDAAuB,CAAC,IAAI,CAAC,CAAA;QAExD,OAAO,UAAU,CAAA;IACrB,CAAC;IAED;;;OAGG;IACH,MAAM,CAAC,OAA0B;QAC7B,iDAAiD;QACjD,MAAM,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAC1C,OAAO,CAAC,IAAI,IAAI,SAAS,CAC5B,CAAA;QACD,IAAI,eAAe,EAAE,CAAC;YAClB,qEAAqE;YACrE,IAAI,eAAe,CAAC,aAAa;gBAC7B,MAAM,IAAI,iEAA+B,CACrC,OAAO,CAAC,IAAI,IAAI,SAAS,CAC5B,CAAA;QACT,CAAC;QAED,0BAA0B;QAC1B,MAAM,UAAU,GAAG,IAAI,uBAAU,CAAC,OAAO,CAAC,CAAA;QAC1C,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,EAAE,UAAU,CAAC,CAAA;QACnD,OAAO,UAAU,CAAA;IACrB,CAAC;CACJ;AA1DD,8CA0DC","file":"ConnectionManager.js","sourcesContent":["import { DataSource } from \"../data-source/DataSource\"\r\nimport { ConnectionNotFoundError } from \"../error/ConnectionNotFoundError\"\r\nimport { DataSourceOptions } from \"../data-source/DataSourceOptions\"\r\nimport { AlreadyHasActiveConnectionError } from \"../error/AlreadyHasActiveConnectionError\"\r\n\r\n/**\r\n * ConnectionManager is used to store and manage multiple orm connections.\r\n * It also provides useful factory methods to simplify connection creation.\r\n *\r\n * @deprecated\r\n */\r\nexport class ConnectionManager {\r\n    /**\r\n     * List of connections registered in this connection manager.\r\n     */\r\n    get connections(): DataSource[] {\r\n        return Array.from(this.connectionMap.values())\r\n    }\r\n\r\n    /**\r\n     * Internal lookup to quickly get from a connection name to the Connection object.\r\n     */\r\n    private readonly connectionMap: Map<string, DataSource> = new Map()\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Public Methods\r\n    // -------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Checks if connection with the given name exist in the manager.\r\n     */\r\n    has(name: string): boolean {\r\n        return this.connectionMap.has(name)\r\n    }\r\n\r\n    /**\r\n     * Gets registered connection with the given name.\r\n     * If connection name is not given then it will get a default connection.\r\n     * Throws error if connection with the given name was not found.\r\n     */\r\n    get(name: string = \"default\"): DataSource {\r\n        const connection = this.connectionMap.get(name)\r\n        if (!connection) throw new ConnectionNotFoundError(name)\r\n\r\n        return connection\r\n    }\r\n\r\n    /**\r\n     * Creates a new connection based on the given connection options and registers it in the manager.\r\n     * Connection won't be established, you'll need to manually call connect method to establish connection.\r\n     */\r\n    create(options: DataSourceOptions): DataSource {\r\n        // check if such connection is already registered\r\n        const existConnection = this.connectionMap.get(\r\n            options.name || \"default\",\r\n        )\r\n        if (existConnection) {\r\n            // if connection is registered and its not closed then throw an error\r\n            if (existConnection.isInitialized)\r\n                throw new AlreadyHasActiveConnectionError(\r\n                    options.name || \"default\",\r\n                )\r\n        }\r\n\r\n        // create a new connection\r\n        const connection = new DataSource(options)\r\n        this.connectionMap.set(connection.name, connection)\r\n        return connection\r\n    }\r\n}\r\n"],"sourceRoot":".."}